{% extends "base.html" %}
{% load static %}

{% block title %}–ì–æ–ª–æ–≤–Ω–∞ - BookingUA{% endblock %}

{% block content %}
<section class="search">
    <div class="search-content">
        <h1>–ó–Ω–∞–π–¥—ñ—Ç—å —ñ–¥–µ–∞–ª—å–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è –≤—ñ–¥–ø–æ—á–∏–Ω–∫—É –∞–±–æ —Ä–æ–±–æ—Ç–∏</h1>
        
        <form method="GET" action="{% url 'search' %}" class="search-form">
            <div class="search-grid">
                <div class="form-group">
                    <label for="location">–ö—É–¥–∏ —ó–¥–µ–º–æ?</label>
                    <input type="text" id="location" name="location" placeholder="–í–≤–µ–¥—ñ—Ç—å –º—ñ—Å—Ç–æ" required>
                </div>
                <div class="form-group">
                    <label for="checkin">–ó–∞—ó–∑–¥</label>
                    <input type="date" id="checkin" name="checkin" required>
                </div>
                <div class="form-group">
                    <label for="checkout">–í–∏—ó–∑–¥</label>
                    <input type="date" id="checkout" name="checkout" required>
                </div>
                <div class="form-group">
                    <label for="guests">–ì–æ—Å—Ç—ñ</label>
                    <select id="guests" name="guests">
                        <option value="1" selected>1 –≥—ñ—Å—Ç—å</option>
                        <option value="2">2 –≥–æ—Å—Ç—è</option>
                        <option value="3">3 –≥–æ—Å—Ç—è</option>
                        <option value="4">4 –≥–æ—Å—Ç—è</option>
                        <option value="5+">5+ –≥–æ—Å—Ç–µ–π</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <button type="submit" class="search-btn">–ó–Ω–∞–π—Ç–∏</button>
                </div>
            </div>
        </form>
    </div>
</section>

<section class="popular-section">
    <div class="container">
        <h2 class="section-title">–ü–æ–ø—É–ª—è—Ä–Ω—ñ –Ω–∞–ø—Ä—è–º–∫–∏</h2>
        <div class="destinations-grid">
            {% for city in popular_destinations %}
            <div class="destination-card">
                <a href="{% url 'city_search' city.slug %}">
                    <div class="destination-image">
                        <img src="{% static 'img/' %}{{ city.slug }}.jpg" alt="{{ city.name }}">
                    </div>
                    <div class="destination-info">
                        <h3>{{ city.name }}</h3>
                        <p>{{ city.description }}</p>
                        <div class="destination-price">–≤—ñ–¥ {{ city.min_price }}‚Ç¥/–¥–æ–±–∞</div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<section class="features-section">
    <div class="container">
        <h2 class="section-title">–ß–æ–º—É –æ–±–∏—Ä–∞—é—Ç—å –Ω–∞—Å</h2>
        <div class="features-grid">
            <div class="feature-card">
                <span class="feature-icon">üõ°Ô∏è</span>
                <h3>–ë–µ–∑–ø–µ—á–Ω—ñ –ø–ª–∞—Ç–µ–∂—ñ</h3>
                <p>–£—Å—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –∑–∞—Ö–∏—â–µ–Ω—ñ —Å—É—á–∞—Å–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –±–µ–∑–ø–µ–∫–∏</p>
            </div>
            <div class="feature-card">
                <span class="feature-icon">‚≠ê</span>
                <h3>–ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω—ñ –≤—ñ–¥–≥—É–∫–∏</h3>
                <p>–¢—ñ–ª—å–∫–∏ —Å–ø—Ä–∞–≤–∂–Ω—ñ –≤—ñ–¥–≥—É–∫–∏ –≤—ñ–¥ –≥–æ—Å—Ç–µ–π, —è–∫—ñ –¥—ñ–π—Å–Ω–æ –∑—É–ø–∏–Ω—è–ª–∏—Å—è –≤ –≥–æ—Ç–µ–ª—è—Ö</p>
            </div>
            <div class="feature-card">
                <span class="feature-icon">üìû</span>
                <h3>–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 24/7</h3>
                <p>–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –≥–æ—Ç–æ–≤–∞ –¥–æ–ø–æ–º–æ–≥—Ç–∏ –≤–∞–º —É –±—É–¥—å-—è–∫–∏–π —á–∞—Å –¥–Ω—è —ñ –Ω–æ—á—ñ</p>
            </div>
            <div class="feature-card">
                <span class="feature-icon">üíé</span>
                <h3>–ù–∞–π–∫—Ä–∞—â—ñ —Ü—ñ–Ω–∏</h3>
                <p>–ì–∞—Ä–∞–Ω—Ç—É—î–º–æ –Ω–∞–π–≤–∏–≥—ñ–¥–Ω—ñ—à—ñ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó –∞–±–æ –ø–æ–≤–µ—Ä–Ω–µ–º–æ —Ä—ñ–∑–Ω–∏—Ü—é</p>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('checkin').setAttribute('min', today);
    document.getElementById('checkout').setAttribute('min', today);

    document.getElementById('checkin').addEventListener('change', function() {
        const checkinDate = new Date(this.value);
        checkinDate.setDate(checkinDate.getDate() + 1);
        const minCheckout = checkinDate.toISOString().split('T')[0];
        document.getElementById('checkout').setAttribute('min', minCheckout);
    });

    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    document.querySelectorAll('.destination-card, .feature-card').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
        observer.observe(card);
    });

    const lazyElements = document.querySelectorAll('.destination-card, .feature-card');

    const lazyObserver = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
                lazyObserver.unobserve(entry.target);
            }
        });
    });

    lazyElements.forEach(el => {
        lazyObserver.observe(el);
    });
</script>
{% endblock %}
